---
title: 断点调试
layout: post
categories: 通用
tags: 调试
excerpt: cppvsdbg断点调试
---

```markdown
仅在Qt6.3.0版本测试通过
对于QString类型设置条件断点，判断字符串匹配条件分析QString的内存结构。

```
QString d;
输入d,!。内存结构显示下图所示
![alt text](/assets/img/postsImg/image.png)

即可通过以下表达式，设置条件断点
d->text.d.ptr && strcmp((const char*)d->text.d.ptr, (const char*)u"设备启动超时，请检查确认设备状态后重新启动") == 0
断点即会在满足字符串等于"设备启动超时，请检查确认设备状态后重新启动"时触发。

---
若是想要在vscode下简单的显示，可以使用微软支持的natvis文件，对复杂变量进行映射。如下所示：
在launch.json中添加如下内容：

```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "appname(debug)",
            "type": "cppvsdbg",
            "request": "launch",
            "program": "appname",
            "args": [],
            "stopAtEntry": false,
            "cwd": "${workspaceFolder}/bin/appname/debug",
            "visualizerFile": "${workspaceFolder}/qt6.natvis" // 添加此行，指定natvis文件
        }
    ]
}
```
